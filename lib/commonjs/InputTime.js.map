{"version":3,"sources":["InputTime.js"],"names":["InputTime","React","Component","constructor","props","setModal","state","prefix","modal","date","value","isValid","format","setInput","props_name","setState","name","String","Date","cancel","componentDidUpdate","prevProps","prevState","input","e","render","isi","disabled","isReadonly","open","toDate","onChange","mapStateToProps","core","mapDispatchToProps","dispatch","key","val","type","payload"],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\nimport moment from 'moment';\r\n\r\nimport { View, Text, Button } from 'react-native';\r\n\r\nimport { debounce } from 'lodash';\r\n\r\nimport { connect } from 'react-redux';\r\n\r\nimport { slug, findArrayName } from 'tcomponent';\r\n\r\nimport DateTimePickerModal from 'react-native-modal-datetime-picker';\r\n\r\nclass InputTime extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const props_name = this.props.name\r\n      ? slug(String(this.props.name), '_')\r\n      : '';\r\n\r\n    this.state = {\r\n      prefix: 'modal_time_picker_' + props_name,\r\n      value: this.props.value || new Date(),\r\n      props_name,\r\n    };\r\n\r\n    this.cancel = debounce(this.cancel, 500);\r\n  }\r\n\r\n  open = () => {\r\n    this.props.setModal(\r\n      this.state.prefix,\r\n      !this.props.modal[this.state.prefix]\r\n    );\r\n  };\r\n\r\n  cancel = () => {\r\n    this.props.setModal(this.state.prefix, false);\r\n  };\r\n\r\n  onChange = (date) => {\r\n    const value = moment(date).isValid()\r\n      ? moment(date).format('HH:mm:ss')\r\n      : null;\r\n\r\n    this.props.setInput(this.state.props_name, value);\r\n\r\n    this.setState({ value: moment().format('YYYY-MM-DD') + ' ' + value });\r\n\r\n    this.props.setModal(this.state.prefix, false);\r\n  };\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    try {\r\n      if (\r\n        findArrayName(this.state.props_name, this.props.input) !=\r\n          findArrayName(this.state.props_name, prevProps.input) &&\r\n        findArrayName(this.state.props_name, this.props.input) !=\r\n          this.state.value\r\n      ) {\r\n        const value = moment(this.props.input[this.state.props_name]).isValid()\r\n          ? moment(this.props.input[this.state.props_name]).format('HH:mm:ss')\r\n          : null;\r\n\r\n        this.setState({ value: moment().format('YYYY-MM-DD') + ' ' + value });\r\n\r\n        this.props.setModal(this.state.prefix, false);\r\n      }\r\n    } catch (e) {}\r\n\r\n    if (this.props.value && prevProps.value != this.props.value) {\r\n      const value = moment(this.props.value).isValid()\r\n        ? moment(this.props.value).format('HH:mm:ss')\r\n        : null;\r\n\r\n      this.setState({ value: moment().format('YYYY-MM-DD') + ' ' + value });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const isi = moment(this.state.value).isValid()\r\n      ? moment(this.state.value).format('HH:mm:ss')\r\n      : '';\r\n\r\n    if (this.props.disabled || this.props.isReadonly) {\r\n      return <Text>{isi}</Text>;\r\n    }\r\n\r\n    return (\r\n      <View>\r\n        <View>\r\n          <Button onPress={this.open} title=\"Open\" />\r\n        </View>\r\n        <DateTimePickerModal\r\n          isVisible={this.props.modal[this.state.prefix]}\r\n          date={moment(this.state.value).toDate()}\r\n          mode=\"time\"\r\n          onConfirm={this.onChange}\r\n          onCancel={this.cancel}\r\n        />\r\n        <Text>{isi}</Text>\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n  input: state.core.input || {},\r\n  modal: state.core.modal || {},\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n  setInput: (key, val) =>\r\n    dispatch({\r\n      type: 'SET_INPUT',\r\n      payload: {\r\n        key: slug(String(key), '_'),\r\n        value: val,\r\n      },\r\n    }),\r\n  setModal: (key, val) =>\r\n    dispatch({\r\n      type: 'SET_MODAL',\r\n      payload: {\r\n        key: slug(String(key), '_'),\r\n        value: val,\r\n      },\r\n    }),\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InputTime);\r\n"]}