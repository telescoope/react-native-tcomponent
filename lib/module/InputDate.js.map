{"version":3,"sources":["InputDate.js"],"names":["React","moment","View","Text","Button","TouchableOpacity","debounce","connect","slug","findArrayName","DateTimePickerModal","InputDate","Component","constructor","props","setModal","state","prefix","modal","date","value","isValid","format","setInput","props_name","setState","name","String","Date","cancel","componentDidUpdate","prevProps","prevState","input","e","render","isi","disabled","isReadonly","customButton","open","toDate","onChange","default","mapStateToProps","core","mapDispatchToProps","dispatch","key","val","type","payload"],"mappings":"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","sourcesContent":["import React from \"react\";\r\n\r\nimport moment from \"moment\";\r\n\r\nimport {View, Text, Button, TouchableOpacity} from \"react-native\";\r\n\r\nimport {debounce} from \"lodash\";\r\n\r\nimport {connect} from \"react-redux\";\r\n\r\nimport {slug, findArrayName} from \"tcomponent\";\r\n\r\nimport DateTimePickerModal from \"react-native-modal-datetime-picker\";\r\n\r\nclass InputDate extends React.Component {\r\n   constructor(props) {\r\n      super(props);\r\n\r\n      const props_name = this.props.name\r\n         ? slug(String(this.props.name), \"_\")\r\n         : \"\";\r\n\r\n      this.state = {\r\n         prefix: \"modal_date_picker_\" + props_name,\r\n         value: this.props.value || new Date(),\r\n         props_name\r\n      };\r\n\r\n      this.cancel = debounce(this.cancel, 500);\r\n   }\r\n\r\n   open = () => {\r\n      this.props.setModal(\r\n         this.state.prefix,\r\n         !this.props.modal[this.state.prefix]\r\n      );\r\n   };\r\n\r\n   cancel = () => {\r\n      this.props.setModal(this.state.prefix, false);\r\n   };\r\n\r\n   onChange = date => {\r\n      const value = moment(date).isValid()\r\n         ? moment(date).format(\"YYYY-MM-DD\")\r\n         : null;\r\n\r\n      this.props.setInput(this.state.props_name, value);\r\n\r\n      this.setState({value});\r\n\r\n      this.props.setModal(this.state.prefix, false);\r\n   };\r\n\r\n   componentDidUpdate(prevProps, prevState) {\r\n      try {\r\n         if (\r\n            findArrayName(this.state.props_name, this.props.input) !=\r\n               findArrayName(this.state.props_name, prevProps.input) &&\r\n            findArrayName(this.state.props_name, this.props.input) !=\r\n               this.state.value\r\n         ) {\r\n            const value = moment(\r\n               this.props.input[this.state.props_name]\r\n            ).isValid()\r\n               ? moment(this.props.input[this.state.props_name]).format(\r\n                    \"YYYY-MM-DD\"\r\n                 )\r\n               : null;\r\n\r\n            this.setState({value});\r\n\r\n            this.props.setModal(this.state.prefix, false);\r\n         }\r\n      } catch (e) {}\r\n\r\n      if (this.props.value && prevProps.value != this.props.value) {\r\n         const value = moment(this.props.value).isValid()\r\n            ? moment(this.props.value).format(\"YYYY-MM-DD\")\r\n            : null;\r\n\r\n         this.setState({value});\r\n      }\r\n   }\r\n\r\n   render() {\r\n      const isi = moment(this.state.value).isValid()\r\n         ? moment(this.state.value).format(\"DD-MM-YYYY\")\r\n         : \"\";\r\n\r\n      if (this.props.disabled || this.props.isReadonly) {\r\n         return <Text>{isi}</Text>;\r\n      }\r\n\r\n      return (\r\n         <View>\r\n            <View>\r\n               {!this.props.customButton ? (\r\n                  <Button onPress={this.open} title=\"Open\" />\r\n               ) : (\r\n                  this.props.customButton(this.open)\r\n               )}\r\n            </View>\r\n            <DateTimePickerModal\r\n               isVisible={this.props.modal[this.state.prefix]}\r\n               date={moment(this.state.value).toDate()}\r\n               mode=\"date\"\r\n               onConfirm={this.onChange}\r\n               onCancel={this.cancel}\r\n            />\r\n            {this.props.default && <Text>{isi}</Text>}\r\n         </View>\r\n      );\r\n   }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n   input: state.core.input || {},\r\n   modal: state.core.modal || {}\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n   setInput: (key, val) =>\r\n      dispatch({\r\n         type: \"SET_INPUT\",\r\n         payload: {\r\n            key: slug(String(key), \"_\"),\r\n            value: val\r\n         }\r\n      }),\r\n   setModal: (key, val) =>\r\n      dispatch({\r\n         type: \"SET_MODAL\",\r\n         payload: {\r\n            key: slug(String(key), \"_\"),\r\n            value: val\r\n         }\r\n      })\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InputDate);\r\n"]}